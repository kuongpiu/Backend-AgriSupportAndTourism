(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74c05f85"],{"013a":function(t,e,s){},"2f94":function(t,e,s){"use strict";s.d(e,"b",(function(){return a})),s.d(e,"a",(function(){return n})),s.d(e,"c",(function(){return i}));var r=s("b775");function a(t){return void 0!==t&&null!=t||(t=""),Object(r["a"])({url:"/address/province",method:"get",params:{name:t}})}function n(t,e){return console.log("provinceId, ",t,"name, ",e),Object(r["a"])({url:"/address/district",method:"get",params:{provinceId:t,name:e}})}function i(t,e){return Object(r["a"])({url:"/address/ward",method:"get",params:{districtId:t,name:e}})}},5653:function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{"box-sizing":"content-box",clear:"both","margin-bottom":"5px",height:"100px","padding-bottom":"20px"}},[s("div",{staticStyle:{width:"100px",height:"100%",float:"left","border-radius":"4px",border:"1px solid #bbbbbb"}},[s("el-avatar",{staticStyle:{width:"100%",height:"100%"},attrs:{shape:"square",fit:"cover",src:t.orderDetail.mainImage}})],1),s("div",{staticStyle:{width:"700px",height:"100px","margin-left":"120px"}},[s("div",{},[s("h4",{staticStyle:{"font-weight":"500"}},[t._v(t._s(t.orderDetail.name))]),s("span",{staticStyle:{display:"block","padding-bottom":"3px","font-size":"small"}},[t._v("Số lượng: "+t._s(t.orderDetail.quantity))]),s("span",{staticStyle:{"font-size":"small"}},[t._v("Giá: "),s("span",{staticStyle:{color:"red"}},[t._v(t._s(t.convertPriceToVND(t.orderDetail.price)))])])])])])},a=[],n=s("2861"),i={name:"OrderDetail",props:["orderDetail"],data:function(){return{convertPriceToVND:n["a"]}}},o=i,d=s("2877"),c=Object(d["a"])(o,r,a,!1,null,"5f33c448",null);e["a"]=c.exports},"92a5":function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-button",{staticClass:"address-item",on:{click:t.handleClickAddressItem}},[s("h3",{staticStyle:{"font-weight":"500","margin-top":"0",color:"#4A9FF9"}},[t._v(t._s(t.userAddress.receiver))]),s("span",{staticClass:"address-detail",staticStyle:{"word-break":"break-word"}},[s("span",{staticStyle:{color:"#7c6b6b"}},[t._v(t._s(t.address))])]),s("span",{staticClass:"address-detail"},[t._v("Điện thoại: "),s("span",{staticStyle:{color:"#7C6B6BFF"}},[t._v(t._s(t.userAddress.phoneNumber))])])])},a=[],n=(s("b0c0"),{name:"AddressItem",props:["userAddress"],created:function(){},computed:{address:function(){var t=", ",e="";return this.userAddress.detail.length>0&&(e+=this.userAddress.detail+t),e+=this.userAddress.ward.name+t,e+=this.userAddress.district.name+t,e+=this.userAddress.province.name,e}},methods:{handleClickAddressItem:function(){this.$emit("clickAddressItem",this.userAddress)}}}),i=n,o=(s("9ce8"),s("2877")),d=Object(o["a"])(i,r,a,!1,null,"3109f219",null);e["a"]=d.exports},"9ce8":function(t,e,s){"use strict";s("caac")},a2ae:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{margin:"15px"}},[s("el-row",{attrs:{gutter:5}},[s("el-col",{attrs:{span:14}},[s("el-card",[s("span",{staticStyle:{"font-weight":"600","text-align":"center"},attrs:{slot:"header"},slot:"header"},[t._v("Thông tin sản phẩm")]),s("div",{staticStyle:{"margin-top":"-20px"}},[t._l(t.orderedProducts,(function(t,e){return s("order-detail",{key:e,staticClass:"order-detail",attrs:{"order-detail":t}})})),s("h5",{staticStyle:{color:"#5a5e66","font-weight":"500","margin-top":"-35px",display:"inline-block",float:"right","border-left":"1px solid #99a9bf",padding:"15px 10px"}},[t._v(" Tổng tiền: "),s("span",{staticStyle:{color:"red","font-size":"medium"}},[t._v(t._s(t.convertPriceToVND(t.cartAmount)))])])],2)])],1),s("el-col",{attrs:{span:10}},[s("div",[s("el-card",[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{staticStyle:{"font-weight":"600","text-align":"center"}},[t._v("Địa chỉ giao hàng")]),s("div",{staticStyle:{float:"right",position:"relative",top:"-10px"}},[t.hasAddress?s("div",[t.changeAddress?s("span",{staticStyle:{color:"#f9944a",position:"relative",top:"10px"}},[t._v("Chọn địa chỉ giao hàng")]):s("el-button",{attrs:{plain:"",type:"primary",icon:"el-icon-refresh"},on:{click:function(e){t.changeAddress=!0}}},[t._v(" Đổi địa chỉ ")])],1):s("div",[s("el-button",{attrs:{plain:"",type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.dialogVisible=!0}}},[t._v(" Thêm địa chỉ ")])],1)])]),t.hasAddress?s("div",{staticStyle:{"margin-top":"-10px"}},[t.changeAddress?s("div",t._l(t.addresses,(function(e,r){return s("address-item",{key:e.id,attrs:{"user-address":e},on:{clickAddressItem:function(e){return t.handleClickAddressItem(r)}}})})),1):s("address-item",{attrs:{"user-address":t.addresses[t.addressIndex]}})],1):t._e()])],1),s("div",{staticStyle:{"margin-top":"10px"}},[s("el-card",[s("span",{staticStyle:{"font-weight":"600","text-align":"center"},attrs:{slot:"header"},slot:"header"},[t._v("Hình thức thanh toán")]),s("div",[s("el-radio",{staticClass:"radio-container",attrs:{label:"cod"},model:{value:t.paymentMethod,callback:function(e){t.paymentMethod=e},expression:"paymentMethod"}},[s("span",{staticClass:"radio-text",attrs:{slot:"default"},slot:"default"},[s("svg-icon",{staticClass:"icon",attrs:{"icon-class":"icon-payment-method-cod"}}),t._v(" Thanh toán khi nhận hàng")],1)]),s("el-radio",{staticClass:"radio-container",attrs:{label:"vnpay"},model:{value:t.paymentMethod,callback:function(e){t.paymentMethod=e},expression:"paymentMethod"}},[s("span",{staticClass:"radio-text",attrs:{slot:"default"},slot:"default"},[s("svg-icon",{staticClass:"icon",attrs:{"icon-class":"vnpay-logo-inkythuatso"}}),t._v(" Thanh toán trực tuyến qua VNPay")],1)])],1),s("el-button",{staticClass:"order-button",attrs:{loading:t.buttonOrderLoading,type:"danger"},on:{click:t.handleOrderClick}},[t._v(" Đặt hàng ")])],1)],1)])],1),s("el-dialog",{attrs:{title:"Thêm địa chỉ",visible:t.dialogVisible,center:!0,top:"2vh","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("el-form",{ref:"addressForm",staticStyle:{"padding-bottom":"45px"},attrs:{model:t.addressForm,rules:t.addressRules}},[s("el-form-item",{attrs:{prop:"receiver",tabindex:"1"}},[s("span",{staticStyle:{display:"inline-block",width:"90px","text-align":"left"},attrs:{slot:"label"},slot:"label"},[t._v("Họ và Tên")]),s("el-input",{staticClass:"address-input",attrs:{placeholder:"Họ và tên"},model:{value:t.addressForm.receiver,callback:function(e){t.$set(t.addressForm,"receiver",e)},expression:"addressForm.receiver"}})],1),s("el-form-item",{attrs:{prop:"phoneNumber",tabindex:"2"}},[s("span",{staticStyle:{display:"inline-block",width:"90px","text-align":"left"},attrs:{slot:"label"},slot:"label"},[t._v("Số điện thoại")]),s("el-input",{staticClass:"address-input",attrs:{placeholder:"Số điện thoại"},model:{value:t.addressForm.phoneNumber,callback:function(e){t.$set(t.addressForm,"phoneNumber",e)},expression:"addressForm.phoneNumber"}})],1),s("el-form-item",{attrs:{prop:"province",tabindex:"3"}},[s("span",{staticStyle:{display:"inline-block",width:"90px","text-align":"left"},attrs:{slot:"label"},slot:"label"},[t._v("Tỉnh")]),s("el-autocomplete",{ref:"inputProvince",staticClass:"address-input",attrs:{placeholder:"Cấp tỉnh","value-key":"name","fetch-suggestions":t.fetchProvinceSuggestions},on:{select:t.handleSelectProvince},model:{value:t.addressForm.province.name,callback:function(e){t.$set(t.addressForm.province,"name",e)},expression:"addressForm.province.name"}})],1),s("el-form-item",{attrs:{prop:"district",tabindex:"4"}},[s("span",{staticStyle:{display:"inline-block",width:"90px","text-align":"left"},attrs:{slot:"label"},slot:"label"},[t._v("Huyện")]),s("el-autocomplete",{ref:"inputDistrict",staticClass:"address-input",attrs:{"value-key":"name",placeholder:"Cấp huyện","fetch-suggestions":t.fetchDistrictSuggestions},on:{focus:t.focusDistrict,select:t.handleSelectDistrict},model:{value:t.addressForm.district.name,callback:function(e){t.$set(t.addressForm.district,"name",e)},expression:"addressForm.district.name"}})],1),s("el-form-item",{attrs:{prop:"ward",tabindex:"5"}},[s("span",{staticStyle:{display:"inline-block",width:"90px","text-align":"left"},attrs:{slot:"label"},slot:"label"},[t._v("Xã")]),s("el-autocomplete",{ref:"inputWard",staticClass:"address-input",attrs:{"value-key":"name",placeholder:"Cấp xã","fetch-suggestions":t.fetchWardSuggestions},on:{select:t.handleSelectWard,focus:t.focusWard},model:{value:t.addressForm.ward.name,callback:function(e){t.$set(t.addressForm.ward,"name",e)},expression:"addressForm.ward.name"}})],1),s("el-form-item",{attrs:{prop:"detail",tabindex:"6"}},[s("span",{staticStyle:{display:"inline-block",width:"90px","text-align":"left"},attrs:{slot:"label"},slot:"label"},[t._v("Vị trí cụ thể")]),s("el-input",{staticClass:"address-input",attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"Vị trí cụ thể"},model:{value:t.addressForm.detail,callback:function(e){t.$set(t.addressForm,"detail",e)},expression:"addressForm.detail"}})],1),s("div",{staticStyle:{float:"right","margin-top":"10px"}},[s("el-button",{attrs:{loading:t.buttonSaveLoading,type:"primary",icon:"el-icon-plus",size:"small"},on:{click:t.handleAddAddress}},[t._v("Thêm ")])],1)],1)],1)],1)},a=[],n=s("b85c"),i=s("5530"),o=(s("d81d"),s("b0c0"),s("d3b7"),s("498a"),s("5653")),d=s("92a5"),c=s("2861"),l=s("2f62"),u=s("f8b7"),h=s("2f94"),p={name:"Index",components:{OrderDetail:o["a"],AddressItem:d["a"]},data:function(){return{orderedProducts:[],paymentMethod:"cod",addressIndex:0,changeAddress:!1,buttonOrderLoading:!1,convertPriceToVND:c["a"],dialogVisible:!1,addressForm:{receiver:"",phoneNumber:"",province:{name:""},district:{name:""},ward:{name:""},detail:""},addressRules:{receiver:[{validator:this.checkReceiver}],phoneNumber:[{validator:this.checkPhoneNumber}],province:[{validator:this.checkProvince}],district:[{validator:this.checkDistrict}],ward:[{validator:this.checkWard}],detail:[{validator:this.checkDetailAddress}]},buttonSaveLoading:!1}},computed:Object(i["a"])(Object(i["a"])({},Object(l["b"])(["cart","addresses"])),{},{hasItemInCart:function(){return this.cart.length>0},cartAmount:function(){var t,e=0,s=Object(n["a"])(this.cart);try{for(s.s();!(t=s.n()).done;){var r=t.value;e+=r.quantity*r.shortProductDTO.price}}catch(a){s.e(a)}finally{s.f()}return e},hasAddress:function(){return this.addresses.length>0}}),created:function(){var t=this;this.$store.dispatch("cart/getCart").then((function(e){console.log("cart",t.cart),t.orderedProducts=t.cart.map((function(t){return{productId:t.shortProductDTO.id,mainImage:t.shortProductDTO.mainImage,name:t.shortProductDTO.name,price:t.shortProductDTO.price,quantity:t.quantity}})),console.log("orderedProducts",t.orderedProducts)}))},methods:{handleClickAddressItem:function(t){this.addressIndex=t,this.changeAddress=!1},handleOrderClick:function(){var t=this;if(this.hasAddress){var e=this.orderedProducts.map((function(t){return{productId:t.productId,quantity:t.quantity}})),s={address:{id:this.addresses[this.addressIndex].id},itemOrders:e,paymentMethod:this.paymentMethod};console.log("orderForm",s),this.buttonOrderLoading=!0,Object(u["d"])(s).then((function(e){console.log(e),null==e.url||"cod"===e.status?(t.$message.success("Đặt hàng thành công. Cám ơn bạn đã mua hàng"),t.$store.dispatch("cart/getCart"),t.$router.push("/order")):window.location.href=e.url})).catch((function(e){t.$message.error("Lỗi khi đặt hàng, vui lòng thử lại sau"),console.log(e)})).finally((function(){t.buttonOrderLoading=!1}))}else this.$message.warning("Vui lòng thêm địa chỉ nhận hàng")},handleAddAddress:function(){var t=this;this.buttonSaveLoading=!0,this.$refs["addressForm"].validate((function(e){if(!e)return t.$message.warning("Vui lòng điền đầy đủ thông tin"),t.buttonSaveLoading=!1,!1;console.log("add address",t.addressForm),t.$store.dispatch("user/insertAddress",t.addressForm).then((function(e){t.$message.success("Thêm địa chỉ thành công"),t.dialogVisible=!1})).catch((function(e){t.$message.error("Thêm địa chỉ thất bại, vui lòng thử lại sau"),console.log(e)})).finally((function(){t.buttonSaveLoading=!1}))}))},checkReceiver:function(t,e,s){e&&0!==e.length&&e.trim()||s(new Error("Họ và tên là thông tin bắt buộc !")),s()},checkPhoneNumber:function(t,e,s){e&&0!==e.length&&e.trim()||s(new Error("Số điện thoại là thông tin bắt buộc !")),s()},checkProvince:function(t,e,s){void 0===e.id?s(new Error("Tỉnh là thông tin bắt buộc")):s()},checkDistrict:function(t,e,s){void 0===e.id?s(new Error("Huyện là thông tin bắt buộc")):s()},checkWard:function(t,e,s){void 0===e.id?s(new Error("Xã là thông tin bắt buộc")):s()},checkDetailAddress:function(t,e,s){e&&0!==e.length&&e.trim()||s(new Error("Chưa có địa chỉ !")),s()},fetchProvinceSuggestions:function(t,e){Object(h["b"])(t).then((function(t){e(t)}))},fetchDistrictSuggestions:function(t,e){var s=this.addressForm.province.id;void 0!==s&&Object(h["a"])(s,t).then((function(t){e(t)}))},fetchWardSuggestions:function(t,e){var s=this.addressForm.district.id;void 0!==s&&Object(h["c"])(s,t).then((function(t){e(t)}))},focusDistrict:function(){void 0===this.addressForm.province.id&&(this.$message.warning("Vui lòng chọn Tỉnh trước"),this.$refs["inputDistrict"].$refs.input.blur())},focusWard:function(){void 0===this.addressForm.province.id?(this.$message.warning("Vui lòng chọn Tỉnh"),this.$refs["inputWard"].$refs.input.blur()):void 0===this.addressForm.district.id&&(this.$message.warning("Vui lòng chọn Huyện"),this.$refs["inputWard"].$refs.input.blur())},handleSelectProvince:function(t){this.addressForm.province=t,console.log("select province, ",t),this.addressForm.district={name:""},this.addressForm.ward={name:""}},handleSelectDistrict:function(t){this.addressForm.district=t,console.log("select district, ",t),this.addressForm.ward={name:""}},handleSelectWard:function(t){this.addressForm.ward=t,console.log("select ward, ",t)}}},m=p,f=(s("df6f"),s("2877")),g=Object(f["a"])(m,r,a,!1,null,"50175870",null);e["default"]=g.exports},caac:function(t,e,s){},df6f:function(t,e,s){"use strict";s("013a")},f8b7:function(t,e,s){"use strict";s.d(e,"d",(function(){return a})),s.d(e,"e",(function(){return n})),s.d(e,"c",(function(){return i})),s.d(e,"a",(function(){return o})),s.d(e,"b",(function(){return d}));var r=s("b775");function a(t){return Object(r["a"])({url:"/order",method:"post",data:t})}function n(t){return Object(r["a"])({url:"/order",method:"put",data:t})}function i(t){return Object(r["a"])({url:"/order",method:"get",params:{orderNumber:t}})}function o(){return Object(r["a"])({url:"/order/all",method:"get"})}function d(t){return Object(r["a"])({url:"/order/all-in-farm",method:"get",params:{farmId:t}})}}}]);